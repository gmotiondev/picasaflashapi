<?xml version="1.0"?>
<project name="picasaflashapi" basedir="." default="lib">
	<property file="./build.properties" />
	<taskdef resource="flexTasks.tasks" classpath="${FLEX_HOME}/ant/lib/flexTasks.jar" />
	<target name="lib" depends="docs">
		<tstamp>
			<format property="TODAY" pattern="dd.MM.yyyy" locale="en,UK"/>
		</tstamp>
		<pathconvert property="flex.classes" pathsep=" ">
			<fileset dir="${src.dir}">
				<include name="**/*.as"/>
				<include name="**/*.mxml"/>
			</fileset>
			<compositemapper>
				<packagemapper from="${src.dir}\*.as" to="*"/>
				<packagemapper from="${src.dir}\*.mxml" to="*"/>
				<packagemapper from="${src.dir}/*.as" to="*"/>
				<packagemapper from="${src.dir}/*.mxml" to="*"/>
			</compositemapper>
		</pathconvert>
		<compc output="${bin.dir}/${library.name}.swc" include-classes="${flex.classes}" compute-digest="false">
			<source-path path-element="${src.dir}" />
			<namespace uri="http://www.prasa.sk/picasaflashapi" manifest="${src.dir}/manifest.xml" />
			<in uri="http://www.prasa.sk/picasaflashapi" />
			<metadata description="Picasa Flash API (as3)" title="Picasa Flash API (as3)" date="${TODAY}">
				<creator name="Michal Gron (michal.gron@gmail.com)" />
				<publisher name="Michal Gron (michal.gron@gmail.com)" />
			</metadata>
		</compc>
		<echo>SWC created</echo>
	</target>

	<target name="docs">
		<!-- Clean out the contents of the doc directory, without delete "docs" -->
		<delete includeemptydirs="true">
			<fileset dir="${docs.dir}" includes="**/*" />
		</delete>
		<exec executable="${asdoc.exe}" spawn="no">
			<!-- Place the documentation in the "docs" directory -->
			<arg line="-o ${docs.dir}" />

			<!-- Include in the corelib.swc in the class path -->
			<!--<arg line="-l ${corelib.swc}" />-->

			<!-- Specify the main source path as "src" -->
			<arg line="-sp ${src.dir}" />

			<!-- Document all of the classes in the "src" tree -->
			<arg line="-ds ${src.dir} " />

			<!-- Include the library name in the window title -->
			<arg line="-window-title 'Picasa Flash API Documentation - ${library.name}' "/>
			<arg line="-main-title 'Picasa Flash API Documentation'"/>
		</exec>
	</target>
</project>